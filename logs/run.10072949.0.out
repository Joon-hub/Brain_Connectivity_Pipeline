===========================================
Starting Brain Connectivity Classification
===========================================
Current directory: /home/sjoon/projects/brain_connectivity_classifier
Running on host: cpu43
Start time: Thu Oct 30 05:17:10 PM CET 2025
===========================================
Running: python run.py --config config.yaml --help

======================================================================
              BRAIN CONNECTIVITY CLASSIFICATION PIPELINE              
======================================================================

Mode: FULL DATA
Config: config.yaml
Start time: 2025-10-30 17:17:11

✓ Loaded configuration from config.yaml
✓ Random seeds set to 42

======================================================================
                  STEP 1/6: Load Resting-State Data                   
======================================================================
✓ Created sample with 10 subjects: data/sample/sample_piop2_small.csv
✓ Schema valid: 224 subjects, 26796 connections

======================================================================
            STEP 2/6: Extract Features and Create Dataset             
======================================================================
✓ Extracted 232 unique brain regions
✓ Extracted 232 unique brain regions
✓ Created dataset: 51968 samples (224 subjects × 232 regions)

======================================================================
               STEP 3/6: Train Brain Region Classifier                
======================================================================

============================================================
TRAINING BRAIN REGION CLASSIFIER
============================================================
Samples: 51968
Features: 232
Classes: 232
Subjects: 224

Running 5-fold cross-validation...
  Fold 1: 0.7376
  Fold 2: 0.7392
  Fold 3: 0.7327
  Fold 4: 0.7553
  Fold 5: 0.7381

CV Results: 0.7406 ± 0.0077

Training final model on full dataset...
Training accuracy: 0.8521
============================================================

✓ Model saved: data/processed/trained_model.pkl

======================================================================
               STEP 4/6: Apply Classifier to Task Data                
======================================================================
✓ Schema valid: 200 subjects, 26796 connections
✓ Schema valid: 200 subjects, 26796 connections
✓ Extracted 232 unique brain regions
✓ Created dataset: 46400 samples (200 subjects × 232 regions)

======================================================================
             STEP 5/6: Generate Error Maps and Statistics             
======================================================================
✓ Saved: reports/tables/error_map_rest.csv
✓ Saved: reports/tables/network_summary_rest.csv
✓ Saved: reports/tables/high_error_regions_rest.csv
✓ Saved: reports/tables/low_error_regions_rest.csv
✓ Saved: reports/tables/error_map_task.csv
✓ Saved: reports/tables/network_summary_task.csv
✓ Saved: reports/tables/comparison_rest_vs_task.csv

✓ Generated 7 CSV tables in reports/tables

======================================================================
                  STEP 6/6: Generate Thesis Figures                   
======================================================================
✓ Saved figure: reports/figures/fig1_error_map_rest.png
✓ Saved figure: reports/figures/fig2_network_analysis_rest.png
✓ Saved figure: reports/figures/fig3_error_map_task.png
✓ Saved figure: reports/figures/fig4_rest_vs_task_comparison.png

✓ Generated 4 thesis figures in reports/figures

======================================================================
                          PIPELINE COMPLETE!                          
======================================================================

Summary of Results:
==================

Training Data:
  Subjects: 224
  Regions: 232
  Samples: 51968

Model Performance:
  CV Accuracy: 0.7406 ± 0.0077
  Train Accuracy: 0.8521
  Random Baseline: 0.0043 (232 classes)
  Improvement: 171.8x better than chance

Task Data:
  Subjects: 200
  Samples: 46400


Output Files:
  Models: data/processed/trained_model.pkl
  Tables: reports/tables/ (7 CSV files)
  Figures: reports/figures/ (4 PNG files)

Execution Time: 10m 21s
Completed: 2025-10-30 17:27:32

✓ Provenance logged to reports/tables/provenance.yaml
✅ All done! Results are ready for your thesis.


===========================================
Pipeline finished!
End time: Thu Oct 30 05:27:33 PM CET 2025
Exit code: 0
===========================================
